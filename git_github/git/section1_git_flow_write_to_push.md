# プログラムを書いてからpushまでの流れ

## リポジトリの作成

gitを使うときはリポジトリを作る必要があります  

### リポジトリとはなんぞや

リポジトリとは、ファイルやディレクトリの状態を記録する場所で、保存された状態は、内容の変更履歴として格納されている。変更履歴を管理したいディレクトリをリポジトリの管理下に置くことで、そのディレクトリ内のファイルやディレクトリの変更履歴を記録することができる。

つまりファイルやディレクトリの変更を記録する場所のこと

そして、gitのリポジトリには二つの種類がある  
ローカルリポジトリとリモートリポジトリだ

ローカルリポジトリは手元にある環境、pcの中のリポジトリだ  
リモートリポジトリはgithubなどどこかしらに共有するためのリポジトリである

### リポジトリの作り方

リポジトリには二つの作り方がある

一つはまったく新しいのを作る方法
もう一つはリモートリポジトリからリポジトリをコピーして作成する方法だ

今回説明するのは前者の方法だ  
後者については別の機会に

まずはリポジトリを作ろう

```git
git init
```

終わり

これでまっさらなリポジトリが完成した  
拍子抜けしたかもしれないがこれだけで作れる

初めに作業し始める時だけ使うので二回目以降`git init`はしなくてもよい

## ステージングする

### ステージングとは

変更をindexに登録する作業

#### indexってなに

コミットする前に登録しておかなければいけない場所  
ここでコミットするファイルを選別する

今さっきまで作業していた環境をワーキングツリーというけど、そこを毎回丸ごとコミットしてたらよくないよね、っていう話です  
必要のないファイルをコミットしなくてもいいようにするのがindexの目的  
今わからなくてもいずれわかるようになると思うのでがんばってください

### ステージングしよう

ファイルを指定してステージング

```git
git add <ファイル名>
```

拡張子でまとめてステージングしたいなら

```git
git *.<拡張子>
```

すべてステージングしたいなら

```git
git add .
```

これでステージングは完了した  
次はコミットだぁ

### 本当にステージングできてるかなぁ

心配になった人もいるだろうがちゃんと確認できるので安心してほしい

```git
git status
```

これでどのファイルがindexに登録されてどのファイルが登録されていないかがわかる優秀なコマンドだ

確認にどうぞ

## コミットしよう

### コミットis何

gitにおいて最も重要な機能(だと思っている)

変更をリポジトリに保存する作業である  
これをすることによって前とどういう変更をしたか、追加したファイルや差分を確認することができるようになる

### 結果をコミットする

```git
git commit
```

これでコミットメッセージを書き込むところがでるのでコミットメッセージを書き込んで保存、そのファイルを閉じるとコミットメッセージを書き込んだことになる

コマンドライン上でやってしまいたい人は

```git
git commit -m "<コミットメッセージ>"
```

こっちは一行しか書けないので何行も書きたければ前者のほうを使うと良い

### コミットメッセージを丁寧に書きなさい

コミットメッセージを適当に書くのはやめてください  
どこでどの変更を行ったか、後で見返してわかるように書いてほしい

その方がどこかでエラーが起きたときにどこを変更したか、何が悪かった、どのタイミングでなどを追いやすくなるのでしっかり書こう

コミットメッセージはどれだけ長く書いてもどこかで不具合が起こるわけではないのでしっかりと書こう

### コミットの頻度について

コミットはこまめにしたほうが良い  
ひと段落着いたらコミット、一日の終わりにコミットなどそのレベルでよいのでやってほしい

余りコミットをまとめてやりすぎると変更の量が多すぎてどこを変更したかわからなくなるのでコミットの単位は小さくした方が良い

コミットはどれだけたくさんやってもエラーとかがおこるわけではないので積極的にやってほしい

~~ごめんなさい私もこまめにコミットするようにしますから許してください~~

## pushしてみよう

君の変更をリモートリポジトリに反映させてみよう

まずはどこのリモートリポジトリに保存するか登録しよう  
リモートリポジトリのURLを調べて、

```git
git push <URL> <ブランチ名>
```

毎回URL手打ちかコピペするんすか……  
そんなめんどくさいことやってられっかということで

楽しちゃおう

```git
git remote add origin <URL>
```

originにURLを登録できた  
これからはURLの代わりにoriginってうちこむだけでpushできるようになった[^1]  

以下の通り

```git
git push origin <ブランチ名>
```

とできる

[^1]: originじゃなくても登録できるんだけど慣例的にoriginとつけるものなのでoriginにしておくと無難  

## ミスってしまった君へ

### ステージングする必要のないファイルまでステージングしちゃった

ステージングの取り消しは

#### 初めてステージングしたなら

```git
git rm --cached -r .

git rm --cached -r <ファイル名>
```

上がすべての取り消し  
下が特定のファイルだけ取り消し

#### 二回目以降のステージング取り消し

```git
git reset HEAD

git reset HEAD <ファイル名>
```

上がすべての取り消し  
下が特定のファイルだけ取り消し

### 間違えてコミットしちゃった

#### 直前のコミットをなかったことに

```git
git reset --hard HEAD^
```

`--hard`はコミットを取り消したうえでワーキングツリーの内容も書き換える  
`--soft`はコミットを取り消したうえでワーキングツリーの内容は書き換えない
`HEAD^`は一個前のコミットを意味する。エイリアスとして`@^`も使える  
`HEAD{n}`はnこ前のコミットを指す。  
`HEAD^^^`と`HEAD~3`と`HEAD~~~`と`HEAD~{3}`と`@^^^`は同じ意味。

#### コミットの上書き

直前のコミットを上書きするには

```git
git commit --amend
```

とする  
コミットメッセージの修正とかに使う

## まだまだ覚えることはたくさんだ

- .gitignoreの書き方
- ブランチ
- pull request
- コンフリクトの解決
- その他

まだまだ覚えることが多いからがんばっていこう

2021/12/05  
written by 西永
