# ロボットの回路構成  

ロボットを動かすためには当然回路が必要なわけですが、やっぱりどんなマイコンをどこに使うべきかって悩みますよね。
ということで僕が見たことのあるブロック図を紹介します。

## 豊田高専  

### 2021年度校内ロボコン Aチーム  

伝説の~~産廃~~ロボット。全てはここから始まった。

```mermaid
classDiagram
  class メイン基板 {arduino mega}
  class モタドラハブ { VNH5019 x8 }
  class 足回りモーター {555 x4}
  class 上半身モーター {謎}
  class ラインセンサ {一辺3つ　4方}

　メイン基板 --|> モタドラハブ : PWMx8 + INA,INB
  モタドラハブ --> 足回りモーター
  モタドラハブ --> 上半身モーター
  ラインセンサ --|> メイン基板 : アナログ
```

ロリコン？そんなものついてるわけないじゃないですかやだなー。  
実物はこんな感じ。もちろん全部ユニ基です。  
![kounai2020](/circuit/images/PXL_20210303_072732322.jpg)  

まあでも実働部員5人＋教育ほぼなしという劣悪な環境（？）で動かすところまで持って行ったのは褒めてほしい。というか入部してから3か月やぞ。  
まあけなしてくれてもいいんですけど。  

### 2021年度本ロボ　Aチーム  

オルテンシアの悪口はそこまでだ！

```mermaid
classDiagram
  class メイン基板 {
    arduino mega
    twelite
　}
  class 足回り基板 {
    nucleo F446RE
    VNH5019 x 4
  }
  class 上半身基板 {
    nucleo F446RE
    VNH5019 x 4
  }
  class ステッピングモタドラ {
    L6470 x5
    肩とかの制御
  }
  class ステッピングモーター
  class 足回りモーター {
    555 x2
    ロリコン付き
  }
  class 上半身モーター {
    消滅
    ロリコン付き
  }
  class 電源基板

  メイン基板 --|> 足回り基板 : UART
  メイン基板 --|> 上半身基板 : UART
  足回り基板 --> 足回りモーター
  上半身基板 --> 上半身モーター
  足回り基板 <|-- 足回りモーター : ロリコン
  上半身基板 <|-- 上半身モーター : ロリコン
  メイン基板 --|> ステッピングモタドラ : SPI
  ステッピングモタドラ --> ステッピングモーター
  電源基板 --|> 足回り基板 : ぱわみ
  電源基板 --|> 上半身基板 : ぱわみ
  電源基板 --|> ステッピングモタドラ : ぱわみ
```

なお本番で使ったDCモーターは足の二つだけの模様。~~あとロリコンが上手く動かなかったので実際はフィードバックしてないです。~~  

![honrobo_2021](images/PXL_20211016_011801383.jpg)  

### 2022年度校内ロボコン Aチーム #虚無の生成  

（製作時）2年生チーム  
回路的には結構先進的なことができたので満足…  

```mermaid
classDiagram
  class 無線基板 {
    arduino uno
    USBホストシールド
    PS5コントローラに接続
　}
  class メイン基板 {
    teensy4.1
　}
  class UCS1 {
    自作モタドラ
    F446RE
  }
  class UCS2 {
    自作モタドラ
    F446RE
  }
  class 足回りモーター {
    735 x2
    ロリコン付き
  }
  class 上半身モーター {
    555　アーム用
    385　装填用
  }
  class 射出ローラー {
    735　x2
  }

　無線基板 --|> メイン基板 : UART
  メイン基板 --|> UCS1 : CAN
  メイン基板 --|> UCS2 : CAN
  UCS1 --> 足回りモーター
  UCS2 --> 射出ローラー
  UCS2 --> 上半身モーター
  UCS1 <|-- 足回りモーター : ロリコン
  電源基板 --|> UCS1 : ぱわみ
  電源基板 --|> UCS2 : ぱわみ
```

この時ロボAで3年ぶりに自作モタドラが使われたらしい。  
ちなみに表面実装部品も3年ぶり(?)  
![2022_kounai_1](images/PXL_20220414_091647256.jpg)  
この校内ロボコンでモタドラ、電源、teensy4.1、CAN通信の動作実証が行われ、本ロボに繋がってゆくことになる。  
![2022_kounai_2](images/PXL_20220422_083725864.jpg)  
なお、arduino unoの問題か無線の遅延が結構やばめだった。

### 2022年度校内ロボコン Aチーム しぐれ弐  

（設計時）1年生チーム  

```mermaid
classDiagram
  class メイン基板 {
    arduino mega
    USBホストシールド
    PS4コントローラに接続
　}
  class 足回り基板 {
    nucleo F446RE
    VNH5019 x 4
  }
  class 上半身基板 {
    nucleo F446RE
    VNH5019 x 4
  }
  class 足回りモーター {
    555 x4
  }
  class 上半身モーター {
    555 x2 展開用
  }
  class 電磁弁

  メイン基板 --|> 足回り基板 : UART
  メイン基板 --|> 上半身基板 : UART
  足回り基板 --> 足回りモーター
  上半身基板 --> 上半身モーター
  電源基板 --|> 足回りモーター : ぱわみ
  電源基板 --|> 上半身モーター : ぱわみ
  メイン基板 --|> 電磁弁
```

僕は写真撮ってないので提供求ム  
モーター制御基板は2021本ロボで使用したものの流用  
メイン基板はarduin megaとユニ基で作成。無線が結構切れてて大変そうだった  

### 2022年度本ロボ Aチーム  

```mermaid
classDiagram
  class PC {
    さごたんゲーミングPC
    USB->CAN変換してる
　}
　class 下半身センサハブ {
    teensy4.1
  }
  class UCS1 {
    自作モタドラ
    F446RE
  }
  class 足回りモーター {
    735 x3
    ロリコン付き
  }
  class 操舵ステッピング {
    L6470 x3
  }

  class 上半身センサハブ {
    teensy4.1
  }
  class UCS2 {
    自作モタドラ
    F446RE
  }
  class 上半身ステッピング {
    L6470 x2
  }
  class 上昇モーター{
    555 x2
  }
  class ローラー用モタドラ {
    PIC32MX
  }
  class ローラー用モーター {
    735 x4
  }

  下半身センサハブ --|> UCS1 : CAN
  UCS1 --> 足回りモーター
  UCS1 <|-- 足回りモーター : ロリコン
  下半身センサハブ --|> 操舵ステッピング : SPI

  上半身センサハブ --|> UCS2 : CAN
  UCS2 --> 上昇モーター
  UCS2 --> 上半身モーター
  上半身センサハブ --|> 上半身ステッピング : SPI
  上半身センサハブ --|> ローラー用モタドラ : SPI
  ローラー用モタドラ --> ローラー用モーター
  ローラー用モタドラ <|-- ローラー用モーター : ロリコン

  PC --|> 電源基板 : CAN
  PC --|> 上半身センサハブ : CAN
  PC --|> 下半身センサハブ : CAN
  PC --|> 電磁弁基板 : CAN
  電磁弁基板 --> LED
```

なかなかに複雑な感じになってますね。まあこれは図がびみょい感もある。あ、ﾊﾟﾜﾐ系統は省略してます。  
基本的に上半身、下半身、電源、LEDの四系統にCANバスを介して分かれています。  
![2022_honrobo](images/PXL_20221023_062332670.jpg)  

また追記しますね