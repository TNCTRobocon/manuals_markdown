# kicadについて
## 概要
kicadとは、回路基板を設計できるソフトのことです。
ロボAでは主にkicadを使用しています。
しかも無料です、はやく入れましょう！

## 必要なもの
- PC
- マウス（あるとイライラ度低減の可能性）
- つおいこころ
- githubのアカウント(あるとおいしいかも)

## 注意
kicadはたまに、勝手に英語モードになったりします。

kicadと仲良くなることで、その現象は治るかもしれません。
仲良くしましょう。（治るとは言っていない）

## 入れ方
web上で検索したら出てきます。
(後日記述)

## エディター
基本的には、

1.ファイル作成

2.回路図エディター

3.（シンボルエディター）

4.フットプリント割り当て

5.PDBエディター

の順で基板設計を行っていきます。

一項目ずつ大まかに説明します。

### ファイル作成
ファイル名や保管場所は自分的に意味が通じるものにしましょう。
さっきのファイルはどこ？！消えた？！ってことになりかねません。
もちろん、私は経験済みです。

### 回路図エディター
回路図を作成します。
シンボル（部品）と配線、ラベルで構成すれば基本大丈夫です。

### シンボルエディター
初期状態で入っていない部品はここから自作しましょう。
基本的にはしなくていいですし、先人（神）が作ってくれたものもありますので、まずは漁りましょう。

### フットプリント割り当て
これが一番きついと思います。
数ある型番の中から、自分たちが使いたいものを選択します。
間違えると煽られるので、気を付けましょう。

### PDBエディター
基板上の部品の配置や基板の大きさを決め、配線していきます。

## 使い方
<details><summary>ファイル作成
  </summary>
  
![image](https://user-images.githubusercontent.com/110577719/222023381-dabaf5f7-7314-424c-ae85-85eba5787c16.png)
kicadを開いたら、左上の「ファイル」から新規プロジェクトを選択します。
プロジェクト名を決めます。
  
この時に、だrrrrるってならない名前にしましょう。
そうしましたら、ファイル名.kicad_proの中に二つのファイルがはいっているものが表示されます。
緑のアイコンをしているのがPCBエディター、よくわからない色をしているのが回路図エディターです。
最初は、回路図エディターを使用していきます
  </details>
  
<details><summary>回路図エディター
  </summary>
  
回路図を書いていきます。
ファイル生成時の用紙サイズはA4ですが、大きくしたければして、小さくしたければ小さくできます。
小さい用紙に詰めると見にくくて面倒なので、適度に余裕をもたせ、いい感じにしましょう。
抵抗やLED、リレーなどの部品を、右列の上から三番目にある、何かの回路記号（わかる人いますか？）のマークのやつから取り出せます。
種類が多く、普通に探すのは面倒なので、検索をかけましょう。
抵抗ならR、コンデンサならCなどです。（後述の資料としてまとめています。）
![image](https://user-images.githubusercontent.com/110577719/222024201-f455e360-9a9f-492e-a7ef-cbf39e4c71cf.png)

シンボルの下のGNDのマークをしているところは、電源ポートを選択できます。
GNDや＋5Vなどはよく使いますね。
![image](https://user-images.githubusercontent.com/110577719/222025024-033c8803-0617-4015-afb0-04e3d845c0e4.png)

ラベルを使うといい感じな回路図が作れます。（LED1って書いてあるやつ）
![image](https://user-images.githubusercontent.com/110577719/222026434-6cc98bfa-610b-4fdf-a848-27fea8be290b.png)

回路図を書き終えたらアノテーションをします。
使用した部品に番号（名前）を付けます。
cad側で基本やってくれるので、大変な作業ではありません。
ちなみに、自分で命名することもできるので、コネクターごとに何につなげるかなどの情報を与えたものを付けるとわかりやすい回路図になります。
  </details>
    
<details><summary>シンボルエディター
  </summary>
  
シンボルを作ることができます。
私はあまり詳しくなくて、説明できない状態なのでちょっと保留（数か月前に諦めた）
  </details>
  
<details><summary>フットプリントの割り当て
  </summary>
  
回路図ができたらフットプリントの割り当てをします。
めっちゃ種類がありますので、がんばって探していきます。
ここで、表面実装にするのか、部品の大きさは何に当てはまるか、基板の大きさは何mmにするのかなど、部品と基板についての設計をします。
どこかの誰かさんはこれの確認を怠ったせいでほかの部員に煽られたので、ちゃんと確認しましょう。

（割愛していますが、回路図と同じように、フットプリントが探し回って見つからなかったときは自作しましょう。）

割り当てし終わったら回路図エディターに戻って、上部にあるツールから「回路図から基板を更新」でPCBエディターに移ります。
特に問題が起きなければ、エラーや警告表示は出ません。
何か出るときは、大体何かのフットプリントが割り当てられていないか、ミスしているかです。
![image](https://user-images.githubusercontent.com/110577719/222053125-cee94175-20a4-4177-b8bf-c847299378c2.png)
  </details>
  
## PCBエディター
<details><summary>配置
  </summary>
  
部品の配置をします。
部品の配置は使いやすさやはんだ付けするときの状況、配線のしやすさなどを考慮して決めていきましょう。
この時にコネクタやLEDの配置も決めるので、使いやすい位置に配置しましょう。
  
  <img src="https://user-images.githubusercontent.com/110577719/224208724-1dd9001e-5afa-422d-a161-aaf347cab909.png" width="47%">
  <img src="https://user-images.githubusercontent.com/110577719/224209060-7a5ae8fc-292a-4805-9f24-e333bf0fdda4.png" width="47%">
  </details>
  
<details><summary>配線
  </summary>
  
部品間に配線をしていきます。
右列の上から4個目の青線で配線できます。
配線は、レイヤーを分けて行います。
基本二層でよいので、F.CuとB.Cuを使いましょう。
一番右の「外観」とあるところから選びます。
ちなみに、裏配線をしたい場合はビアを通して行います。
ビアなどについては後述の資料で。
部品の配置は使いやすさやはんだ付けするときの状況、配線のしやすさなどを考慮して決めていきましょう。
この時にコネクタやLEDの配置も決めるので、使いやすい位置に配置しましょう。
左上の5個のアイコンの下に「配線：ネットクラスの幅を使用」とあります。
そこから事前に定義されているサイズをえらんで、配線の幅の列の下にある+から使用する配線の幅を追加します。
そこに流れる電流の量によって何mmの配線を使用するかを決めます。
基本的には、幅1mmくらいで1Aです。

できるだけ直角に配線をすることは避けましょう。
なぜかと言いますと、急に難しい話になりますが、インピーダンスが曲がり角で変化することによってノイズが発生しやすくなってしまうためです。
絶対にノイズが発生したくないときは、孤形に配線をしましょう。

![image](https://user-images.githubusercontent.com/110577719/224206997-3a39aca2-d9f5-4a1f-b9df-ba4bb968d380.png)
</details>
  
<details><summary>べた塗
  </summary>

配線で使った電源ポートやラベルの層を作ることができます。
銅箔ですね。
基本的にはGNDはべた塗で済ませます。
そうすることによって、また難しい話ですが、GNDのインピーダンスが小さくなり、ノイズの広がりを防げます。
やり方は、右列の上から7番目にあるアイコンをクリックし、使用するネットとレイヤーを選択することで使えます。
![image](https://user-images.githubusercontent.com/110577719/222047666-34455478-de3f-4aa6-8dc7-5c25bf51a9ab.png)
</details>
  
<details><summary>基板の外形
  </summary>
  
基板の外形を決めるときは、レイヤーをEdge.cutsにして、右列の下の3つから外形を書いていきましょう。
もしくは左上の「配置」から色々選択してください。

こんなことができちゃいます（しなくていいです）
![image](https://user-images.githubusercontent.com/110577719/222050556-fbc32de5-029f-485b-b224-e390d4b3dff3.png)
  </details>
  
<details><summary>DRC
  </summary>
  
デザインルールチェッカーでは、配線のし忘れや部品が重なっているときに忠告をしてくれます。
左のバーから「検査」を選び、デザインルールチェッカーを開きます。
「DRCを実行」でエラーや警告を検知してくれます。
これは、配線が燃える可能性とかは検知しないので、エラーと警告が0でもだめな基板はだめです。
![image](https://user-images.githubusercontent.com/110577719/224204955-581699d0-5f94-4e37-87ad-fca394ba3f3f.png)
  
（エラーや警告で配線用語がめっちゃ出てくるので、後述する資料にちょっとまとめておきますね。）
</details>
  
## その他
<details><summary>資料
  </summary>
  
- 回路図エディターでの部品の探し方

|  部品  |  シンボル名  |  ライブラリ  |
| ---- | ---- | ---- |
| 抵抗 | R | device |
| コンデンサ | C | device |
| 電解コンデンサ | C_Polarized | device |
| LED | LED | device |
| ダイオード | D | device |
| プッシュスイッチ | sw_push | switch |
|  NPNトランジスタ  |  Q_NPN_BCE  |  device  |
|  PNPトランジスタ  |  Q_PNP_BCE  |  device  |
|  NchMOSFET  |  Q_NMOS_GDS  |  device  |
|  PchMOSFET  |  Q_PMOS_GDS  |  device  |
| ロジック関連 | 74~~~~~~ | 74xxGxx |
|  コネクタ  |  Conn_0nx0m  |  connector_geneic  |

(n=行,m=列)
  
- ラベル

配線ごとに名前を付けることができ、ほかの回路班、制御班、未来の自分が回路図を見たときもわかりやすくなり、使用するとみんなが幸せになれます。
右列の下から三番目から追加できます。
また、入力ピンなのか、出力ピンなのかはちゃんと設定しましょう。
双方向ピンは面倒になりやすいので、あまり使わないほうがいいと思います。
![image](https://user-images.githubusercontent.com/110577719/222611540-ffc9003b-3d4e-4236-ae53-9579c96f8584.png)

- フットプリントライブラリ

|  部品  |  ライブラリ名  |  備考  |
| ---- | ---- | ---- |
|  抵抗（リード）  |  Resistor_THT  |  普通の抵抗はR_Axial_DIN207_L6.3  |
|  抵抗（表面実装）  |  Resistor_SMD  |  1608Metric HandSolder  |
|  コンデンサ（表面実装）  |  Capasitor_SMD  |  1608Metric HandSolder 4.7uFは2012  |
|  LED（表面実装）  |  LED_SMD  |  1608Metric HandSolder  |
|  コネクタ  |  Robocon_connector  | 使用する通信等にあわせてコネクタの種類を変える |
|  部室のダイオード  |  Robocon_Diode  |  SMAF  |

- 配線用語

| 用語 | 意味 |
| ---- | ---- |
| シルク | 基板上に書かれる文字とか。（R1、C2、U3など） |
| ビア | 放熱や裏に配線を回したいときに使うやつ。穴が開く。 |
| フットプリント | 部品の形。 |
| レイヤー | F.CuやB.Cuなどの層。 |
| ルールエリア | べた塗や配線をしない区域を設定できる。 |
| 導体ゾーン | べた塗した範囲。 |

- PCBエディター上でのテキストの入れ方

基板で名刺を作りたい方、必見です。
基板上にテキストを入れていきます。
誰作成で、なんの基板なのかを入力したいときに便利です。

やり方は、PCBエディター上で、「配置」から「テキストを追加」を選択します。
自分の入れたい文字とその幅や高さを調節します。

↓こんな感じ
![image](https://user-images.githubusercontent.com/110577719/222176995-9c491bd2-2147-4549-b60f-391693c7578e.png)

- 3Dビューアー

これを活用すると、いい感じな基板が作れます。
これをみるとモチベが爆誕し、見た目とかもなんとなくわかるのでうれしい機能です。
PCBエディターで、「表示」から3Dビューアーを選択すると、できた基板が3Dで出てきます。

↓こんな感じ
![image](https://user-images.githubusercontent.com/110577719/222175864-c197e7d0-0c9d-4726-a6c5-185b32da8961.png)

</details>

<details><summary>バージョンの違い
  </summary>
  kicadは現在、バージョンがいくつかあります。
  皆さんにダウンロードしていただきたいのは、kicad6.0です。
  なぜかというと、最近（2023/2月）、7.0がでたので、あまり部内で使いなれておらず、教えられないからです。
  ですが、入れていても何ら問題はないし、おもしろいので入れてもよいと思います。（わたしは入れてます）
  ただ、ここに書いてあるのはkicad6.0での操作方法及び画面表示です。
  基本的に操作方法自体は変わってないですが、アイコンの場所等は変わっているので、気を付けてください。
  あともちろんですが、7.0で作ったデータは6.0で開けないので、そこも注意です。
  
  7.0は6.0にこんな機能を足したやつです。
  - テキストフォント
  - テキストボックス
  <img src="https://user-images.githubusercontent.com/110577719/224229407-8fec6ad8-f4f6-4dca-bae6-45186447e67e.png" width="40%">

  - 3Dマウス対応
  - sentry加入
  - 自動配線
  </details>
