# Arduinoを使ってみよう！ (その4)

## もくじ
* 1.Arduino IDEの起動と画面の説明 //[リンク](how-to-use-arduino-1.md)
* 2.Arduinoを使ってLチカをしてみよう！ //[リンク](how-to-use-arduino-2.md)  
* 3.Arduinoを使ってPWMを体験してみよう！　//[リンク](how-to-use-arduino-3.md)  
* 4.Arduinoを使ってデジタル入力を体験してみよう！ //今回はこれ  
* 5.Arduinoを使って自由に明るさを変えてみよう！（上級編） //[リンク](how-to-use-arduino-5.md)  

## 4.Arduinoを使ってデジタル入力を体験してみよう！  
さて、前回まででArduinoから自由な強さで電気を流すことができるようになった。  
ここまでできれば、LEDやモーターの制御も可能だ。(実際には...)  
ただ、このままだとLEDの制御などはいちいちパソコンから書きこむ方法でしかパターンを変えられない。  
例えば「ボタンを押したら点滅パターンが変わる。」などはまだ実装できないわけだ。  
そこで今回は、ボタンなどを用いて、もっと高度な制御をしてみよう。  
### 4-1 回路を作ろう！
今回も前回までの回路を使用するが、今回はそれに加えてボタン周りの回路も作ってみよう。  
早速だが、回路図を下に示す。  
![image](https://user-images.githubusercontent.com/106954082/229812537-ec3e04f6-68d6-4a35-89b5-57218924b581.png)   
上がボタン周り、下がLED周り（作成済み）だ。  
この回路図をみて、ブレッドボードで回路を作ってみよう。

#### ブレッドボードでボタンを使うときに注意すること
ロボAでブレッドボードにさせるボタンだと、下の画像のようなものがある。 

<img src="https://user-images.githubusercontent.com/106954082/229797275-47264c90-9cb8-4903-b07d-a60a2d24b4e5.png" width="30%">
  
このタイプのボタンだと4本あしが生えているが、常につながっているところと、ボタンを押したらつながるところがある。

<img src="https://user-images.githubusercontent.com/106954082/229802169-8f804468-a9be-4d6b-94cd-6507c2230653.png" width="30%">
    
水色は常につながっている。 対して桃色は、ボタンを押すとつながるようになっている。  
これを覚えておこう。  

### 4-2 プログラムを書こう！
さて、ブレッドボードの使い方には慣れてきただろうか。  
回路ができたらプログラムを書こう。  
参考に、"2.Arduinoを使ってLチカをしてみよう！"のプログラムをここに置いておく。  
```cpp
//出力を11番ピン, 間隔を100ミリ秒にした例
void setup(){
  pinMode(11, OUTPUT); //ピンの初期設定
}
  
void loop(){
  digitalWrite(11, HIGH); //11番ピンから電流を流す
  delay(100);             //100ms待つ
  digitalWrite(11, LOW);  //11番ピンからの電流を止める
  delay(100);             //100ms待つ
}
```
今回行う処理の中心になるのは、  
"ボタンが押されたら" LEDに電気を流す という条件分岐の部分である。  

ではまず、"ボタンが押された"ことを検知する部分を作っていこう。  
先ほどの回路では、プルダウン抵抗を使用している。  
いきなり言われても、わけがわからないと思うが、プルダウン抵抗を使用すると、  
ボタンを押したときにArduino側に大きな電気が流れるようになる。
| ボタン | 押す | 押さない |
----|----|----
| プルアップ抵抗 | LOW(ちいさい) | HIGH(おおきい) |
| プルダウン抵抗(今回) | HIGH | LOW |
    
(HIGHとかLOWとかは後述する)  
  
<br> 
   
あるピンに(比較的大きな)電気が来ているかどうかを、調べてくれる関数は、  
```cpp
digitalRead(pin);
```
である。  
この関数を使うと、指定したピンに電気が来ているかどうかをHIGH(1)かLOW(0)で返してくれる。

次に条件分岐の部分を作るものを見ていこう。  
聞いたことがあるかもしれないが、 if(-else)文 と呼ばれる部分になる。  
```cpp
if(条件式){
  //条件を満たす(true)とここに書かれたものが実行される。
}else{
  //ここに書くと、条件を満たさないとき(false)に実行される。(省略できる。)
}
```  
このように書く。  

条件式は、true(1 など) or false(0) の答えを返すものとして処理される。  
では、ここで ```digitalRead()```を条件式に入れるとどうなるだろうか。  
そう。HIGH (1) は、true(1 など)に当てはまり、LOW(0) は、false(0)に当てはまる。  

なお、if文の最後には関数のように";"(セミコロン)は不要である。  

ここまでわかったら、書くことができるはずだ。
では、まずは自分の力で書いてみよう。  
つまずいたら今までのことを振りかえってみたり、答えを一度見て考えてみるとよい。

<details> <summary>答えのプログラム例</summary>

<div>

```cpp
//回路図のように 入力 10番ピン 出力を5番ピンにした場合
void setup(){
  pinMode(10, OUTPUT); //ピンの初期設定 (出力)
  pinMode(5, INPUT); //(入力)
}
  
void loop(){
  if(digitalRead(5)){
    //(digitalRead(5) が HIGH)の時に実行される。
    digitalWrite(10, HIGH);
  }else{
    //LOWの時に実行される。
    digitalWrite(10. LOW);
  }
}
```

ちなみに、このほかにも別解が多く存在する。
<br>
今回はif文にも触れてもらう目的であえてif文を用いて書いたが、if文を用いない方法も存在する。
<br>
見やすい・わかりやすいコードを考えて書いてみるとよい。

</div>

</details>

### おまけ＆練習問題
Q: 先ほど触れたif文を使用しない方法でプログラムを書け。

#### 変数について
解答例はまだ教えていない変数というものを使用している。

<details> <summary>答え</summary>

<div>

```cpp
//回路図のように 入力 10番ピン 出力を5番ピンにした場合
void setup(){
  pinMode(10, OUTPUT); //ピンの初期設定 (出力)
  pinMode(5, INPUT); //(入力)
}
  
void loop(){
  int swich; //変数を宣言する。 (ここに、HIGH/LOW の情報が入る)
  
  swich = digitalRead(5); //5番ピンの状態読み取り。 (HIGH(1) or LOW(0) が swich変数に書きこまれる。)  
  digitalWrite(10, swich); //swichに書きこまれている HIGH/LOW によって、digitalWrite()が動作する。  
}
```

</div>

</details>
