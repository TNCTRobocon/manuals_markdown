# 名前空間(namespace)

## 名前空間とは

C++から新しく導入された概念
名前の衝突を避けるために有効に働く

### さらに詳しく

例えば、vector関数を二つ作ったとする。どちらともcallという名前にしたいが名前同士が重複してしまっている  
そんな時に活躍するのが名前空間だ[^1]

名前空間は住所のようなもので、名前が同じ人でも「●●市」の近藤さんと「△△市」の近藤さんのが別人であるとわかる

例えばvector関数を実装したとする。だが、std[^2]にもvectorというものが存在する。このままではどちらのことをさしているのかわからないという状態になる。[^3]  
これを解決するために存在しているのが名前空間である

[^1]: そういう時はよほどのことがない限り変数名、関数名の見直しをお勧めする
[^2]: stdは別の時に説明されているのでそれを参照してほしい
[^3]: C++ではわからないということはないが避けたほうが良いのはたしか

## 名前空間の定義

名前空間の定義方法について詳しく説明する

- 例文
  
```c++
#include<iostream>

namespace hoge{
    using namespace std;

    void huga_print(){
        cout << "huga" <<endl;
    }

    namespace piyo{
        void piyo_print(){
            cout << "piyo" <<endl;
        }

        void huga_print(){
            cout << "huga2" <<endl;
        }
    }
}

int main(){
    hoge::huga_print();
    hoge::piyo::piyo_print();
    hoge::piyo::huga_print();
}
```

- 結果

```markdown
huga
piyo
huga2
```

詳しく見ていこう

### namespace

```c++
namespace hoge{
    //コード
}
```

これはnamespace、名前空間の定義だ
先にnamespaceと書き、次に名前空間名を書くとそれで名前空間が定義できる

また、名前空間の中に名前空間を定義することも可能である

### スコープ解決演算子(大域解決演算子)

:: ←これのことである

これを書くと、名前空間の中のものにアクセス可能になる

名前空間の中の名前空間もこれを使えばその中にもアクセス可能になる

### using

- メリット
  
例にあったように毎回hoge::~ と書くのがﾒﾝﾄﾞｸｻって思った人のためにusingという機能がある

これを使うと楽に書くことができる

```c++
#include<iostream>
//名前空間の定義を省略

using namespace hoge;

int main(){
    hoge_print();
}
```

出力

```markdown
hoge
```

このようにhoge::を省略して書くことができる

- デメリット

メリットと書いたからにはデメリットも書くのが筋だろう(？)

そのデメリットとは、using namespace を使うとせっかく名前空間を使っているのにそのメリットがなくなることだ  
そもそも名前空間がどうして導入されたかを思い出してほしい  
普通に名前衝突しちゃわない？

名前空間を使って安易にusing namespaceをして結果名前が衝突してエラーを起こしたら本末転倒じゃないか  
**だから安易にusing namespaceを使うのは控えてほしい**

また、Cのファイルにあったファイル分割の項でインクルードするファイルにusingを使ったらどうなるか想像ができるだろうか

usingをしていないファイルでusingがされた扱いになってしまい、思わぬ動作をしてしまうことがある  
なので**安易にusingを使うことは控えてほしい**

- 折衷案

usingにはusing namespace以外の使い方がある

```c++
#include<iostream>
//名前空間の定義を省略

using hoge::hoge_print;

int main(){
    hoge_print();
}
```

こうするとhoge_printにだけusingが適用される  
なので名前が衝突するリスクを最小限に抑えることができる

これなら大丈夫と思ったなら大間違いである
影響が小さいとはいえ、名前空間のメリットが小さくなっていること。  
インクルードされた先で衝突して思わぬ動作をしてしまうリスクがいつでも付きまとうことになるということも常に頭に入れておいてほしい

**安易にusingを使うのはやめようね**  
**安易にusingを使うのはやめようね**

大事なことなので二回言いました

2021/11/29
written by 西永
